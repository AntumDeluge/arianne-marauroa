Title  : Database ER
Info   : Description of the database ER model
Keyword: Database, ER, SQL
Author : Miguel Angel Blanch Lardin
Created: 2003/10/07
status : planning

The database ER schema is:

Entities:
---------

entity PLAYER
  {
  PK(username)
  password
  }
  
entity CHARACTERS
  {
  PK(character)
  content
  }
  
entity LOGIN_EVENT
  {
  PK(id)
  address
  timedate
  result
  }
  
entity STATISTICS
  (
  PK(timedate)
  
  bytes_send
  bytes_recv
  
  players_login
  players_logout
  players_timeout
  players_online
  )

entity RPOBJECT
  (
  PK(id)
  slot_id
  )
  
entity RPATTRIBUTE
  (
  PK(object_id)
  PK(name)
  value
  )

entity RPSLOT
  (
  object_id
  name
  PK(slot_id)
  )
  
Relations:
----------

relation PLAYER_CHARACTERS
  {
  PK(player_username)
  PK(characters_character)
  }
  
relation PLAYER_LOGIN_EVENT
  {
  PK(player_username)
  PK(login_event_id)
  }


So we can translate this to SQL easily and we would obtain:

CREATE TABLE player
  (
  id BIGINT PRIMARY KEY NOT NULL,
  username VARCHAR(30) NOT NULL,
  password VARCHAR(30) NOT NULL
  );
  
CREATE TABLE characters
  (
  player_id BIGINT NOT NULL,
  charname VARCHAR(30) NOT NULL,
  contents VARCHAR(4096)
  
  PRIMARY KEY(player_id,character)
  );
  
CREATE TABLE loginEvent
  (
  player_id BIGINT NOT NULL,
  address VARCHAR(20),
  timedate TIMEDATE,
  result TINYINT
  );


CREATE TABLE statistics
  (
  timedate TIMESTAMP,
  
  bytes_send INTEGER,
  bytes_recv INTEGER,
  
  players_login INTEGER,
  players_logout INTEGER,
  players_timeout INTEGER,
  players_online INTEGER,
  
  PRIMARY KEY(timedate)
  );

CREATE TABLE rpobject
  (
  id INTEGER NOT NULL PRIMARY KEY,
  slot_id INTEGER
  );
  
CREATE TABLE rpattribute
  (
  object_id INTEGER NOT NULL,
  name VARCHAR(64) NOT NULL,
  value VARCHAR(255),
  PRIMARY KEY(object_id,name)
  );

CREATE TABLE rpslot
  (
  object_id INTEGER NOT NULL,
  name VARCHAR(64) NOT NULL,
  slot_id INTEGER AUTO_INCREMENT NOT NULL,
  
  PRIMARY KEY(slot_id)
  );
